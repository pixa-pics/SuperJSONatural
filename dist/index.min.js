!function(){var t={exports:{}};class e{constructor(){this.b64CC=Uint8Array.of(65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47),this.b64C=Uint8Array.of(255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,62,255,255,255,63,52,53,54,55,56,57,58,59,60,61,255,255,255,0,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51),this.TPS=[{id:0,typeof:"undefined",instanceof:void 0},{id:1,typeof:"object",instanceof:void 0},{id:2,typeof:"number",instanceof:Object},{id:3,typeof:"number",instanceof:void 0},{id:4,typeof:"boolean",instanceof:void 0},{id:5,typeof:"number",instanceof:void 0},{id:6,typeof:"number",instanceof:void 0},{id:7,typeof:"number",instanceof:void 0},{id:8,typeof:"number",instanceof:void 0},{id:9,typeof:"number",instanceof:void 0},{id:10,typeof:"string",instanceof:""},{id:11,typeof:"object",instanceof:ArrayBuffer},{id:12,typeof:"object",instanceof:Int8Array},{id:13,typeof:"object",instanceof:Uint8Array},{id:14,typeof:"object",instanceof:Uint8ClampedArray},{id:15,typeof:"object",instanceof:Int16Array},{id:16,typeof:"object",instanceof:Uint16Array},{id:17,typeof:"object",instanceof:Int32Array},{id:18,typeof:"object",instanceof:Uint32Array},{id:19,typeof:"object",instanceof:Float32Array},{id:20,typeof:"object",instanceof:Float64Array},{id:21,typeof:"object",instanceof:BigInt64Array},{id:22,typeof:"object",instanceof:BigUint64Array},{id:23,typeof:"object",instanceof:Array},{id:24,typeof:"object",instanceof:""}],this.packedHead=new Uint8Array(0),this.packedBody=new Uint8Array(0),this.packedBodyOffset=0,this.tails=[],this.textEncoder=new TextEncoder,this.textDecoder=new TextDecoder}bytesToBase64(t){var e=2,i=0,n=0|t.length,r=4*Math.ceil(n/3),s=new Uint8Array(r);for(e=2,i=0;(0|e)<(0|n);e=(e+3|0)>>>0,i=(i+4|0)>>>0)s[i]=255&this.b64CC[t[e-2|0]>>2],s[i+1|0]=255&this.b64CC[(3&t[e-2|0])<<4|t[e-1|0]>>4],s[i+2|0]=255&this.b64CC[(15&t[e-1|0])<<2|t[e]>>6],s[i+3|0]=255&this.b64CC[63&t[e]];(0|e)==(n+1|0)&&(s[i]=255&this.b64CC[t[e-2|0]>>2],s[i+1|0]=255&this.b64CC[(3&t[e-2|0])<<4],s[i+2|0]=255&"=".charCodeAt(0),s[i+3|0]=255&"=".charCodeAt(0),i=(i+4|0)>>>0),(0|e)==(0|n)&&(s[i]=255&this.b64CC[t[e-2|0]>>2],s[i+1|0]=255&this.b64CC[(3&t[e-2|0])<<4|t[e-1|0]>>4],s[i+2|0]=255&this.b64CC[(15&t[e-1|0])<<2],s[i+3|0]=255&"=".charCodeAt(0),i=(i+4|0)>>>0);var o="";for(e=0;e<s.length;e=(e+1024|0)>>>0)o=o.concat(String.fromCharCode.apply(null,s.subarray(e,Math.min(e+1024|0,s.length))));return o}charCodeAt(t){return 255&t.charCodeAt(0)}getb64CBufferResults(t){return Uint8Array.of(t>>16,t>>8&255,255&t)}getb64CBufferResultsBy4(t,e,i,n){return Uint8Array.of(t>>16,t>>8&255,255&t,e>>16,e>>8&255,255&e,i>>16,i>>8&255,255&i,n>>16,n>>8&255,255&n)}getBase64Code(t){return t=255&(0|t),255&(0|this.b64C[t])}getb64CBuffer(t){return(this.getBase64Code(t[0])<<18|this.getBase64Code(t[1])<<12|this.getBase64Code(t[2])<<6|this.getBase64Code(t[3])|0)>>>0}base64ToBytes(t,e,i){e|=0;var n=new Uint8Array(t.length-e|0),r=n.length,s=0,o=0;for(s=0,o=e;(s+7|0)<(0|r);s=(s+8|0)>>>0,o=(o+8|0)>>>0)n[0|s]=255&t.charCodeAt(0|o),n[s+1|0]=255&t.charCodeAt(o+1|0),n[s+2|0]=255&t.charCodeAt(o+2|0),n[s+3|0]=255&t.charCodeAt(o+3|0),n[s+4|0]=255&t.charCodeAt(o+4|0),n[s+5|0]=255&t.charCodeAt(o+5|0),n[s+6|0]=255&t.charCodeAt(o+6|0),n[s+7|0]=255&t.charCodeAt(o+7|0);for(;(0|s)<(0|r);s=(s+1|0)>>>0,o=(o+1|0)>>>0)n[0|s]=255&t.charCodeAt(0|o);var a=t.endsWith("==")?2:t.endsWith("=")?1:0,c=t.length-e|0,h=new Uint8Array(c/4*3),d=new Uint8Array(16);for(s=0,o=0;(s+16|0)<(0|c);s=(s+16|0)>>>0,o=(o+12|0)>>>0)d=n.slice(0|s,s+16|0),h.set(this.getb64CBufferResultsBy4(this.getb64CBuffer(d.subarray(0,4)),this.getb64CBuffer(d.subarray(4,8)),this.getb64CBuffer(d.subarray(8,12)),this.getb64CBuffer(d.subarray(12,16))),o);for(;(0|s)<(0|c);s=(s+4|0)>>>0,o=(o+3|0)>>>0)h.set(this.getb64CBufferResults(this.getb64CBuffer(n.slice(0|s,s+4|0))),o);return new i(h.buffer.slice(0,h.length-a))}getType(t){switch(typeof t){case"object":if(null==t)return typeof t===this.TPS[0].typeof?this.TPS[0]:this.TPS[1];if(t instanceof ArrayBuffer)return this.TPS[11];if("buffer"in t){if(t.buffer instanceof ArrayBuffer){for(var e=12;(0|e)<=22;e=(e+1|0)>>>0)if(t instanceof this.TPS[(0|e)>>>0].instanceof)return this.TPS[(0|e)>>>0];return this.TPS[24]}return this.TPS[24]}return t instanceof Array?this.TPS[23]:this.TPS[24];case"number":return t==1/0?this.TPS[3]:NaN==t?this.TPS[2]:t!==(0|t)?this.TPS[7]:(t|=0)<0?t<-2147483648?this.TPS[8]:this.TPS[5]:t<=4294967295?this.TPS[6]:this.TPS[8];case"string":return this.TPS[10];case"undefined":default:return this.TPS[0];case"bigint":return this.TPS[8];case"boolean":return this.TPS[4]}}pushTail(t){this.tails.push(t)}resetTails(){this.tails=[]}getTailsLength(){return this.tails.length}getTailAt(t){return this.tails[0|t]}encodeString(t){return this.textEncoder.encode(t)}decodeBuffer(t){return this.textDecoder.decode(t)}encode(t){return this.bytesToBase64(new Uint8Array(t))}encodeSomething(t){const e=this.getType.bind(this),i=this.encodeSomething.bind(this),n=e(t);return n.id>=12&&n.id<=22?t=`$TA_${n.id}_B64$${this.encode(t.buffer)}`:23==(0|n.id)?t.forEach((n,r)=>{const s=e(n).id;s>=12&&s<=24&&(t[r]=i(n))}):24==(0|n.id)&&Object.entries(t).forEach(n=>{const r=e(n[1]).id;r>=12&&r<=24&&(t[n[0]]=i(n[1]))}),t}stringify(t){return JSON.stringify(this.encodeSomething(t))}decode(t,e,i){return this.base64ToBytes(t,e,i)}decode_something(t){const e=this.getType.bind(this),i=this.decode_something.bind(this),n=this.decode.bind(this),r=e(t);if(10==(0|r.id)&&t.startsWith("$TA_")){const e=parseInt(t.charAt(4)+t.charAt(5),10);t=n(t,11,this.TPS[e].instanceof)}else 23==(0|r.id)?t.forEach((e,n)=>{t[n]=i(e)}):24==(0|r.id)&&Object.entries(t).forEach(e=>{t[e[0]]=i(e[1])});return t}parse(t){return this.decode_something(JSON.parse(t))}packEncode(t){var e=t instanceof Uint8Array?t:new Uint8Array(t.buffer),i=0|this.packedBodyOffset,n=this.packedBodyOffset+e.length|0;return this.packedBodyOffset=0|n,this.pushTail(e),"F=".concat(i.toString()).concat("T=").concat(n.toString()).concat("$")}packEncodeSomething(t){const e=this.getType.bind(this),i=this.packEncode.bind(this),n=this.packEncodeSomething.bind(this),r=e(t);return(0|r.id)<=22&&(0|r.id)>=12?t="$TA_".concat(r.id.toString()).concat("_PA&").concat(i(t)):23==(0|r.id)?t.forEach((function(i,r){const s=0|e(i).id;(10==(0|s)||s<=24&&(0|s)>=12)&&(t[0|r]=n(i))})):24==(0|r.id)&&Object.entries(t).forEach((function(i){const r=0|e(i[1]).id;(10==(0|r)||(0|r)<=24&&(0|r)>=12)&&(t[i[0]]=n(i[1]))})),t}pack(t){this.packedBodyOffset=0,this.resetTails();const e=JSON.stringify(this.packEncodeSomething(t)),i=2*e.length+5;let n=new Uint8Array(0);this.packedHead.length<i&&(this.packedHead=new Uint8Array(i));const r=this.textEncoder.encodeInto(e,this.packedHead);let s={read:0,written:0};e.length>r.read&&(n=new Uint8Array(3*(e.length-r.read)),s=this.textEncoder.encodeInto(e.slice(r.read,e.length),n));const o=0==(0|s.written)?r.written:r.written+n.subarray(0,s.written).length,a=4+o+this.packedBodyOffset;this.packedBody.length<a&&(this.packedBody=new Uint8Array(a));const c=this.packedHead.subarray(0,r.written),h=n.subarray(0,s.written);this.packedBody.set(c,4),h.length>0&&this.packedBody.set(h,c.length+4),this.packedBody[0]=255&o,this.packedBody[1]=o>>8&255,this.packedBody[2]=o>>16&255,this.packedBody[3]=o>>24&255;let d=4+o;for(let f=0;(0|f)<(0|this.getTailsLength());f=(f+1|0)>>>0)this.packedBody.set(this.getTailAt(0|f),0|d),d=d+this.getTailAt(0|f).length|0;return this.packedBody.slice(0,0|a)}unpack(t){const e=4+(t[0]|t[1]<<8|t[2]<<16|t[3]<<24),i=JSON.parse(this.decodeBuffer(t.subarray(4,e)));return this.unpackDecodeSomething(i,t,e)}unpackDecode(t,e,i,n,r){return new r(t.slice(e+i|0,e+n|0).buffer)}unpackDecodeSomething(t,e,i){const n=this.getType.bind(this),r=this.unpackDecodeSomething.bind(this),s=this.unpackDecode.bind(this);switch(n(t).id){case 10:if(t.startsWith("$TA_")){const n=parseInt(t.charAt(4)+t.charAt(5));t=t.slice(12,t.length-1);const[r,o]=t.split("T=").map(Number);t=s(e,i,r,o,this.TPS[n].instanceof)}break;case 23:t.forEach((s,o)=>{const a=n(s).id;[10,23,24].includes(a)&&(t[o]=r(s,e,i))});break;case 24:Object.entries(t).forEach(([s,o])=>{const a=n(o).id;[10,23,24].includes(a)&&(t[s]=r(o,e,i))})}return t}}t.exports=e,t=t.exports}();